<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Rafferty Parker and Ben Anderson (University of Otago)" />


<title>Analysis of electric vehicle usage patterns in New Zealand</title>

<script src="EVBB_SummaryReport_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="EVBB_SummaryReport_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="EVBB_SummaryReport_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="EVBB_SummaryReport_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="EVBB_SummaryReport_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="EVBB_SummaryReport_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="EVBB_SummaryReport_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="EVBB_SummaryReport_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="EVBB_SummaryReport_files/navigation-1.1/tabsets.js"></script>
<script src="EVBB_SummaryReport_files/navigation-1.1/codefolding.js"></script>
<link href="EVBB_SummaryReport_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="EVBB_SummaryReport_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analysis of electric vehicle usage patterns in New Zealand</h1>
<h3 class="subtitle"><em>Summary Statistical Report</em></h3>
<h4 class="author"><em>Rafferty Parker and Ben Anderson (University of Otago)</em></h4>
<h4 class="date"><em>Last run at: 2019-01-22 10:29:47</em></h4>

</div>


<pre class="r"><code># set correct order for days of the week
#levels(as.factor(df$day_of_week))

df$day_of_week &lt;- ordered(df$day_of_week, levels=c(&quot;Monday&quot;, &quot;Tuesday&quot;,
                                                   &quot;Wednesday&quot;, &quot;Thursday&quot;, 
                                         &quot;Friday&quot;, &quot;Saturday&quot;, &quot;Sunday&quot;))
# set charge type
#df$chargeType &lt;- ifelse(df$charge_power_kw &gt; 0, &quot;Standard charge&quot;, &quot;Not charging&quot;) # appears not to set not charging label. Why?
# have switched with method I used previously, seems to work fine.
#df$chargeType &lt;- ifelse(df$charge_power_kw &gt;= 7, &quot;Fast charge&quot;, &quot;Standard charge&quot;)

# set charge type order so charts make sense from left (std) to right (fast)

df$chargeType &lt;- cut(df$charge_power_kw, c(-Inf, 0.01, 7, Inf), labels = c(&#39;Not charging&#39;, &#39;Standard charging&#39;, &#39;Fast charging&#39;))
df$chargeType &lt;- factor(df$chargeType, ordered = TRUE)

#&lt;- ordered(df$chargeType, levels=c(&quot;Not charging&quot;, &quot;Standard charge&quot;, &quot;Fast charge&quot;))

df$qHour &lt;- hms::trunc_hms(df$time, 15*60) # truncate to previous 15 min

dt &lt;- as.data.table(df) # creates a data.table for fast data crunching

chargingDT &lt;- dt[charge_power_kw &gt; 0] # select just charging

df$id &lt;- factor(df$id, ordered = TRUE) # To get N vehicles

df$time &lt;- hms::round_hms(df$time, 60)

# removal of silly percentage values
df$state_of_charge_percent[df$state_of_charge_percent &gt; 100] &lt;- NA
df$state_of_charge_percent[df$state_of_charge_percent &lt; 0] &lt;- NA</code></pre>
<div id="note" class="section level1">
<h1><span class="header-section-number">1</span> Note</h1>
<p>Based on and inspired by the <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/764270/electric-chargepoint-analysis-2017-domestics.pdf">UK DoT statistical report 2018</a>.</p>
<p>Data used: /run/user/1001/gvfs/smb-share:server=storage.hcs-p01.otago.ac.nz,share=hum-csafe,user=student%5Cparra358/Research Projects/GREEN Grid/externalData/flipTheFleet/safe/testData/2019_01_07/EVBB_processed_founders.csv</p>
<p>Observations: 73836 Observed charging: 50056 observations (power demand &gt; 0)</p>
</div>
<div id="definitions" class="section level1">
<h1><span class="header-section-number">2</span> Definitions:</h1>
<p>The data consisted of 73836 data points from 3 vehicles over M months (X - Y, 2018) derived from FlipTheFleet’s <a href="https://flipthefleet.org/ev-black-box/">blackbox recorder</a>. The recorder provided measurements at 1 minute frequency of charging behaviour and battery charge state as well as geo-location via GPS.</p>
<p>The capacity of most domestic charging is between 1.8kW to 7kW, whereas charging power above 7kW is available at purpose-built charging stations<span class="citation">[@concept2018]</span>. Each charging event was therefore seperated into “Fast” (&gt; = 7kW) and “Standard” (below 7kW).</p>
<p>A charging event was defined as a continuous sequence of 1 minute observations per vehicle when &gt; 0 kW was demand was observed. <em>Difficult to do accurately without date column due to charging occurring through the night when date hashes change. These hashes do not appear to have an order so we cannot distinguish the 2nd from the 3rd Thursday (for example) and so establish correct multi-day sequences.</em></p>
<p>For a discussion of data limitations see Section <a href="#dataIssues">9</a>.</p>
</div>
<div id="key-findings" class="section level1">
<h1><span class="header-section-number">3</span> Key Findings:</h1>
<pre class="r"><code>stdMedian &lt;- median(chargingDT[chargeType == &quot;Standard charging&quot;]$charge_power_kw, na.rm = TRUE)
stdMean &lt;- mean(chargingDT[chargeType == &quot;Standard charging&quot;]$charge_power_kw, na.rm = TRUE)
  
fastMedian &lt;- median(chargingDT[chargeType == &quot;Fast charging&quot;]$charge_power_kw, na.rm = TRUE)
fastMean &lt;- mean(chargingDT[chargeType == &quot;Fast charging&quot;]$charge_power_kw, na.rm = TRUE)</code></pre>
<ul>
<li><em>Power supplied</em>: The median power supplied during a standard charging was 2.93 kW. The mean was slightly lower/higher at 2.82 kW. Fast charging observations had a higher median of 20.37 kW (mean = 23.59);</li>
<li><em>Charging duration</em>: Charging durations tended to fall into one of two groups - longer ‘overnight’ charges with a median of XX hours and shorter events during the day both at standard and fast charge rates with a median duration of XX hours. <em>Gets truncated at midnight as not possible to determine exact sequence of days</em></li>
<li><em>Time of Day</em>: charging events were more frequent at specific times of the day and day of the week with more evening and over-night charging during weekdays and more day-time charging at weekends. The power demand also varied according to time of day and day of the week.</li>
</ul>
</div>
<div id="observed-demand" class="section level1">
<h1><span class="header-section-number">4</span> Observed demand</h1>
<p>Figure <a href="#fig:obsPower">4.1</a> shows the distribution of observed charging kW demand by inferred charge type. This plot shows that fast charges are relatively rare in the dataset whilst standard charges are much more common and, partly due to our definition, are concentrated around 3 kW. At the present time charging at home is likely to be predominatly standard charging whilst charging outside the home is likely to be a mix of the two.</p>
<pre class="r"><code>p &lt;- ggplot2::ggplot(chargingDT, aes(x = charge_power_kw, fill = chargeType, binwidth = 0.1)) +
  geom_histogram() +
  facet_grid(. ~ chargeType, scales = &quot;free&quot;)

# now draw the plot with any fancy extras we want
p + labs(y = &quot;Density&quot;,
       x = &quot;Power (kW)&quot;) +
  guides(fill = guide_legend(title = &quot;Charge type:&quot;)) +
  scale_fill_manual(values=cbgPalette) + # use colour-blind friendly palette
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure"><span id="fig:obsPower"></span>
<img src="EVBB_SummaryReport_files/figure-html/obsPower-1.png" alt="Observed power demand distribution by day of the week and charge type where charging observed" width="672" />
<p class="caption">
Figure 4.1: Observed power demand distribution by day of the week and charge type where charging observed
</p>
</div>
<p>The median power supplied during a standard charging was 2.93 kW. The mean was slightly lower/higher at 2.82 kW. Fast charging observations had a higher median of 20.37 kW (mean = 23.59).</p>
<pre class="r"><code>stdQT &lt;- quantile(chargingDT[chargeType == &quot;Standard charging&quot;]$charge_power_kw)
fastQT &lt;- quantile(chargingDT[chargeType == &quot;Fast charging&quot;]$charge_power_kw)</code></pre>
<p>75% of standard charging observations were 2.76 kW or more but the figure was 13.34 kW or more for fast charging</p>
</div>
<div id="daily-demand" class="section level1">
<h1><span class="header-section-number">5</span> Daily demand</h1>
<pre class="r"><code>p &lt;- ggplot2::ggplot(dt, aes(x = day_of_week, colour = chargeType, group = day_of_week)) +
  geom_boxplot(aes(y = charge_power_kw)) +
  facet_grid(. ~ chargeType)

# now draw the plot with any fancy extras we want
p + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  labs(x = &quot;Day of week&quot;,
       y = &quot;Power (kW)&quot;) +
  guides(colour = guide_legend(title = &quot;Charge type:&quot;)) +
  scale_colour_manual(values=cbgPalette) + # use colour-blind friendly palette
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<div class="figure"><span id="fig:dailyPower"></span>
<img src="EVBB_SummaryReport_files/figure-html/dailyPower-1.png" alt="Observed power demand distribution by day of the week and charge type" width="672" />
<p class="caption">
Figure 5.1: Observed power demand distribution by day of the week and charge type
</p>
</div>
<p>Figure <a href="#fig:dailyPower">5.1</a> shows the distribution of observed charging kW demand by day of the week. We can see that fast charging varies in demand but standard charging is reltively constant across days.</p>
<blockquote>
<p>Discuss any other patterns</p>
</blockquote>
</div>
<div id="duration" class="section level1">
<h1><span class="header-section-number">6</span> Charging duration</h1>
<p>Fig: Histogram of charging event durations (faceted by fast vs standard) <em>Can’t do without true date column - see above</em></p>
<blockquote>
<p>Discuss any other patterns</p>
</blockquote>
<blockquote>
<p>NB: are the durations being truncated at midnight as we do not have consecutive dateTimes?</p>
</blockquote>
</div>
<div id="time-of-charging" class="section level1">
<h1><span class="header-section-number">7</span> Time of charging</h1>
<pre class="r"><code>plotDT &lt;- chargingDT[, .(count = .N), keyby = .(qHour, chargeType, day_of_week)]

# make a weekend facet label
plotDT &lt;- plotDT[, weekEnd := &quot;Weekend&quot;]
plotDT &lt;- plotDT[day_of_week != &quot;Saturday&quot; &amp; day_of_week != &quot;Sunday&quot;, weekEnd := &quot;Week day&quot;]

p &lt;- ggplot2::ggplot(plotDT, aes(x = qHour, y = count, colour = day_of_week)) +
  geom_line() +
  facet_grid(weekEnd ~  chargeType)
  
p + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  labs(x = &quot;Time of day&quot;,
       y = &quot;Count&quot;) +
  guides(colour = guide_legend(title = &quot;Day of week:&quot;)) +
  scale_colour_manual(values=cbgPalette) + # use colour-blind friendly palette
  theme(legend.position = &quot;bottom&quot;)</code></pre>
<div class="figure"><span id="fig:chargeTime"></span>
<img src="EVBB_SummaryReport_files/figure-html/chargeTime-1.png" alt="Count of observed charging events by type,day of week and time" width="672" />
<p class="caption">
Figure 7.1: Count of observed charging events by type,day of week and time
</p>
</div>
<p>Figure <a href="#fig:chargeTime">7.1</a> shows the distribution of observed charging by time of day and day of the week. Aggregating counts in this way emphasises the times at which charging most commonly occurs and we can see…</p>
<blockquote>
<p><em>XX haven’t edited beyond here</em> XX</p>
</blockquote>
<p>Fig: profile of median charging demand by time of day and day of the week <em>Difficult to do without date column</em> faceted by at home vs not at home <em>Would need GPS data</em></p>
<p>Charging demand varies considerable by time of day, day of the week and imputed location. Weekdays show … whilst weekends show. Saturdays and Sundays vary with…</p>
<p>Fig: profile of start and end of charging events by time of day and day of the week <em>This we can do</em> faceted by at home vs not at home <em>Would need GPS data</em></p>
<p>At home charging events tended to begin at HH:MM during weekdays and HH:MM at weekends. <em>We can get “Slow” charging events rather than “home”</em></p>
<p>Domestic charging has a noticeably different profile to charging patterns for chargepoints at other locations. It suggests that it is common for plug-in vehicle owners to charge overnight at home, and perhaps use the more powerful public chargepoints to top up during the day.</p>
<blockquote>
<p>Discuss any other patterns</p>
</blockquote>
</div>
<div id="state-of-charge" class="section level1">
<h1><span class="header-section-number">8</span> State of charge</h1>
<p>The duration of charging events (see Section <a href="#duration">6</a>) suggests that EVs may be ‘plugged in’ at home (and elsewhere) for considerable durations.</p>
<p>Fig: Distribution of state of charge when evening charge event starts ‘at home’ (histogram (or joy plot) by day of week) <img src="plots/SOC_when_charging_begins.png" alt="SOC when charging begins" /></p>
<p>The figure shows that many vehicles arrive home with greater than 50% charge remaining and would therefore be able to transfer energy to the home during the evening grid peak as a form of demand response.</p>
<p>Fig: Mean state of battery charge at the first ‘at home’ charging observation by hour and day of the week <em>No “at home” data with SOC</em></p>
<blockquote>
<p>should show the timing of ‘coming home’ battery state?</p>
</blockquote>
<p>Fig: Distribution of duration of charge events starting ‘at home’ in the evening (by day of the week) <em>Duration difficult to accurately determine without date due to charging occurring through the night</em></p>
<p>The figure shows that vehicles may then be available for further demand response and/or re-charging for up to XX hours from this point.</p>
<blockquote>
<p>Discuss any other patterns</p>
</blockquote>
</div>
<div id="dataIssues" class="section level1">
<h1><span class="header-section-number">9</span> Data limitations</h1>
<p>The GPS data used to determine location is not available for x% of observations possibly due to in-garage parking or other physical signal inhibition. Location cannot be deduced in these cases and has instead been imputed as the ‘last’ GPS location recorded. These errors may affect the location/‘at home’ coding.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
